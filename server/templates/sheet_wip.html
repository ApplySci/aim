<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your scoresheet is being created now</title>
    <link rel=stylesheet type='text/css' href='/static/clean.css'>
    <script>
        var strm = new EventSource("/create/stream");

        strm.onmessage = function(event) {
          console.log(event);
          document.getElementById('doclist').innerHTML = event.data;
          strm.close();
        };
    </script>
</head>
<body>
    <h1>Now creating your new tournament scoresheet.</h1>
    <p>You should receive an email at {{ session['email'] }} from google,
    with a link to it, as soon as it's ready. This page should incorporate
    the information when the document is ready, and a button for it will
    appear below.</p>
    <p>Once it's there, open the sheet.
    <em>Then follow the instructions at the top of the
    README tab.<em> You will create a copy of that sheet.
    Once you've done that, come back here, and press this button:</p>
    <p><button id=copymade>I have copied the spreadsheet</button></p>

    <fieldset>
        <p id=doclist></p>
    </fieldset>

<script defer>
document.getElementById("copymade").addEventListener("click", function() {
    document.getElementById('doclist').innerHTML =
        "<img src='/static/Loading_Key.gif'>";
    let xhr = new XMLHttpRequest();
    let timestamp = new Date().getTime();
    xhr.open("GET", "{{ url_for('create.poll_sheetlist')}}?t=" + timestamp, true);
    xhr.send();
});
</script>
</body>
</html>
